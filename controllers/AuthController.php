<?php
require_once __DIR__ . '/../models/User.php';
session_start();
class AuthController {
 private $userModel;
 public function __construct($conn) {
 $this->userModel = new User($conn);
 }
 public function register($email, $password) {
 return $this->userModel->register($email, $password);
 }
 public function verify($code) {
 return $this->userModel->verify($code);
 }
 public function login($email, $password) {
 $result = $this->userModel->login($email, $password);
 if (is_array($result)) {
 $_SESSION['user'] = $result['email'];
 header("Location: index.php?action=home");
 exit();
 }
 return $result;
 }
 public function logout() {
 session_destroy();
 header("Location: index.php?action=login");
 exit();
 }
}
?>